
@model ControladoresCore.ViewModels.GruposDeContactosVM

@using System.Web.Mvc.Html
@using ControladoresCore.Extensiones
@using ControladoresCore.ViewModels
@{
    ViewBag.Title = "Grupos de contactos- Registro";
}
<div class="row">
    <div class="col-md-10">

    </div>
</div>
@using (Html.BeginCard("Grupo seleccionado"))
{
    using (Html.BeginForm())
    {
        @Html.AntiForgeryToken()

        <div class="form-horizontal">
        @Html.ValidationSummary(true, "", new { @class = "text-danger" })
        @Html.HiddenFor(model => model.Id)
            <div class="row">
                <div id="divCampos" class="col-sm-12">
                    <div class="form-group">
                        @Html.LabelFor(model => model.Nombre, htmlAttributes: new { @class = "control-label col-md-3" })
                        <div class="col-md-9">
                            @Html.EditorFor(model => model.Nombre, new { htmlAttributes = new { @class = "form-control", disabled = "disabled", @readonly = "readonly" } })
                            @Html.ValidationMessageFor(model => model.Nombre, "", new { @class = "text-danger" })
                        </div>
                        
                        <div class="form-group">
                            @Html.LabelFor(model => model.Observaciones, htmlAttributes: new { @class = "control-label col-md-3 pt-2" })
                            <div class="col-md-9">
                                @Html.TextAreaFor(model => model.Observaciones, new { @class = "form-control ", @disabled = "disabled", @readonly = "readonly" })
                                @Html.ValidationMessageFor(model => model.Observaciones, "", new { @class = "text-danger" })
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            @using (Html.BeginCard("Contactos"))
            {
                <div style="height:400px; overflow-y:auto">
                    <table id="TablaComponentes" class="table">
                        <thead style="background-color: #67a8e496;">
                            <tr>
                                <th scope="col"></th>
                                <th style="width: 25%" scope="col">Nombre</th>
                                <th style="width: 35%" scope="col">Alias</th>
                                <th style="width: 20%" scope="col" mask="<img style='width: 20px; height:20px; display:block;margin:auto;' src='/template/img/{VAL}.svg'>">Es Organización</th>
                                <th style="width: 35%" scope="col">Tipos</th>
                                <th style="width: 20%" scope="col">Email</th>
                                <th style="width: 35%" scope="col">Teléfono</th>
                                <th style="width: 20%" scope="col">Abrir</th>
                            </tr>
                        </thead>
                        <tbody>
                            @for (int i = 0; i < Model.Contactos.Count; i++)
                            {
                                <tr>
                                    <th scope="row"></th>
                                    <td>
                                        <div class="form-group">
                                            <div class="col-md-12">
                                                @Html.HiddenFor(model => model.Contactos[i].Id)
                                                @Html.DisplayFor(model => model.Contactos[i].NombreCompleto, new { htmlAttributes = new { @class = "form-control", @disabled = "disabled" } })

                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <div class="form-group">
                                            <div class="row col-md-12">
                                                @Html.DisplayFor(model => model.Contactos[i].Alias, new { htmlAttributes = new { @class = "form-control", @disabled = "disabled" } })
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <div class="form-group">
                                            <div class="row col-md-12">
                                                @if (Model.Contactos[i].EsUnaOrganizacion)
                                                {
                                                    <img style='width: 20px; height:20px; display:block;margin:auto;' src='/template/img/checkbox_True.svg'>
                                                }
                                                else
                                                {
                                                    <img style='width: 20px; height:20px; display:block;margin:auto;' src='/template/img/checkbox_False.svg'>
                                                }
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <div class="form-group">
                                            <div class="row col-md-12">

                                                @Html.DisplayFor(model => model.Contactos[i].TiposDeContacto, new { htmlAttributes = new { @class = "form-control", @disabled = "disabled" } })
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <div class="form-group">
                                            <div class="col-md-12">
                                                @Html.DisplayFor(model => model.Contactos[i].Email, new { htmlAttributes = new { @class = "form-control", @disabled = "disabled" } })
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <div class="form-group">
                                            <div class="row col-md-12">
                                                @Html.DisplayFor(model => model.Contactos[i].Telefono, new { htmlAttributes = new { @class = "form-control", @disabled = "disabled" } })
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <div class="form-group">
                                            <div class="col-md-12">
                                                <a href="/@ViewBag.Seccion/Contactos/Registro/@Model.Contactos[i].Id">Abrir</a>
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                             }
                        </tbody>
                    </table>
                </div>
             }
        </div>
    }
}

<div class="card" id="dyn_2">
    <h4 style="padding:1px; background-color:var(--color-primary)" class="card-header mt-0"></h4>
    <div class="card-body fade-in p-2">
        <div class="col-lg-12 pull-left botonera">
            @HtmlHelperExtension.Boton("GruposDeContactos", "Listado", ViewBag.Seccion)

            @HtmlHelperExtension.Boton("GruposDeContactos", "Update", Model.Id, ViewBag.DatosDeUnaPagina.AutorizadoAOperarLaPagina, ViewBag.Seccion)
            <div class="btn-group dropup mo-mb-2">
                <button type="button" class="btn btn-info dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Acciones</button>
                <div class="dropdown-menu">
                    
                    @HtmlHelperExtension.BotonDeAcciones("GruposDeContactos", "Delete", Model.Id, ViewBag.DatosDeUnaPagina.AutorizadoAOperarLaPagina, ViewBag.DatosDeUnaPagina.AutorizadoAAccionesEspeciales, pSeccion: ViewBag.Seccion)
                </div>
            </div>
           
            <a class="btn btn-danger removeOnIframe" href="/intranet/Home/Index">Cancelar</a>
        </div>
    </div>
</div>

<div id="accordion">
    <div class="card">
        <div class="card-header p-0" style="background-color: #adadad;border-color:grey;color:white;" id="headingOne" data-toggle="collapse" data-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
            <h5 class="mb-0">
                <button class="btn btn-link" data-toggle="collapse" data-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                    Historia del Registro
                </button>
            </h5>
        </div>

        <div id="collapseOne" class="collapse" aria-labelledby="headingOne" data-parent="#accordion">
            <div class="card-body">
                @Html.Raw(Model.Historia)
            </div>
        </div>
    </div>
</div>

<script src="~/template/plugins/forms/summernote/summernote.js"></script>
<script src="~/template/js/HtmlEditor.js"></script>
<script>
    $(function () {
        $('.note-editable').attr('contenteditable', 'false');
        $('.note-toolbar').remove();
    })
</script>


